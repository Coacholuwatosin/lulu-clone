(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[39190],{17545:function(t,e,r){"use strict";r.r(e),r.d(e,{__N_SSP:function(){return Q},default:function(){return T}});var n=r(67294),a=r(4730),i=r(59499),o=r(50029),s=r(16835),c=r(87794),u=r.n(c),l=r(85169),d=r(32601),m=r(97848),p=r(94184),C=r.n(p),_=r(34078),v=r.n(_),f=r(10104),h=r(9831),y=r(10063),w=r(8942),j=r(47017),g=r(72208),x=r(34174),b=r(67730),E=r(55496),k=r(23474),V=r.n(k),N=r(85893),O=["item"];function D(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function I(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?D(Object(r),!0).forEach((function(e){(0,i.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var P=function(){var t=(0,n.useState)(!0),e=t[0],r=t[1],c=(0,n.useState)(!1),p=c[0],_=c[1],k=(0,n.useContext)(h.V),D=k.user,P=k.login,Q=(0,g.P)(),T=(0,n.useContext)(w.R).locale,S=(0,n.useContext)(y.A9),B=S.cartId,M=S.ready,Z=S.currency,q=S.getCartEventData,A=S.updateCartItem,F=(0,j.CM)({skip:!M||!B,variables:{id:B,visit:!0}}),L=F.data,R=F.loading,Y=null===L||void 0===L?void 0:L.cart,U=(0,b.wt)(Y),G=U.cartItems,W=U.subtotal,X=U.cartItemsQuantity,H=W.map((function(t){return(0,b.Qq)(t)})),K=(0,n.useMemo)((function(){return(0,b.t8)(G,T,Q)}),[T,Q,G]),z=(0,x.x)(!0),J=z.trackEvent,$=z.viewEvent,tt=(0,j.Ew)(),et=(0,s.Z)(tt,1)[0],rt=function(){var t=(0,o.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(B){t.next=2;break}return t.abrupt("return");case 2:window.sessionStorage.removeItem("checkoutEmail"),et({variables:{cartId:B,currency:Z,language:T.toUpperCase()},onCompleted:function(t){var e,r=t.checkout,n=null===r||void 0===r||null===(e=r.proceedToCheckout.checkout)||void 0===e?void 0:e.publicId;n&&(window.location.href=v()(null!==f.Dr&&void 0!==f.Dr?f.Dr:"","development"===f.Gv?"":"/checkout",(0,E.Ld)(T),"/".concat(n)))}});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),nt=(0,n.useRef)(X);(0,n.useEffect)((function(){X!==nt.current&&J("Cart Item ".concat(X<nt.current?"Removals":"Additions"),{tealiumData:I({},q(Y))}),nt.current=X}),[Y,X,q,J]);var at=(0,n.useCallback)(function(){var t=(0,o.Z)(u().mark((function t(e,r){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",B&&A({variables:{cartId:B,productId:e,quantity:r,isCartDrawerVisible:!1}}));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),[B,A]);(0,n.useEffect)((function(){r(!M||R)}),[M,R]),(0,n.useEffect)((function(){e||$(I(I({},q(Y)),{},{tealium_event:"cart"}))}),[Y,q,e,$]),(0,n.useEffect)((function(){function t(t){t.persisted&&_(!1)}return window.addEventListener("pageshow",t),function(){window.removeEventListener("pageshow",t)}}),[]);var it=0===K.length;return(0,N.jsxs)("div",{className:V().wrapper,children:[(0,N.jsx)("title",{children:(0,N.jsx)(l.cC,{id:"Cart | Lulu"})}),(0,N.jsxs)("div",{className:V().cart,children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:V().header,children:[(0,N.jsx)("div",{className:V().title,children:(0,N.jsx)(l.cC,{id:"Your Cart"})}),(0,N.jsxs)("div",{className:V().itemsCount,"data-testid":"items-count",children:[X," ",(0,N.jsx)(l.cC,{id:"{cartItemsQuantity, plural, one {item} other {items}}",values:{cartItemsQuantity:X}})]})]}),e?(0,N.jsx)("div",{style:{marginTop:24,height:300},children:(0,N.jsx)(m.gb,{})}):it?(0,N.jsx)("div",{className:V().emptyCart,"data-testid":"empty-cart",children:(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{className:V().emptyCartTitle,children:(0,N.jsx)(l.cC,{id:"Your Cart is Empty"})}),(0,N.jsx)("div",{className:V().emptyCartMessage,children:D?(0,N.jsx)(l.cC,{id:"Head back to <0>the Bookstore</0> to continue shopping!",components:{0:(0,N.jsx)(m.rU,{className:V().link,url:"/".concat(T,"/search")})}}):(0,N.jsx)(l.cC,{id:"Did you leave something in your cart? <0>Log in now</0> to see your saved cart.",components:{0:(0,N.jsx)("button",{onClick:P,className:V().loginButton})}})})]})}):(0,N.jsx)("div",{className:V().itemsContainer,children:(0,N.jsx)("div",{children:(0,N.jsx)(m.CC,{items:K,onQuantityChange:at,hideRemovedItems:!0,children:function(t){var e,r=t.item,n=(0,a.Z)(t,O);return(0,N.jsx)(m.bE,I(I({item:r,currency:Z,totalItemsText:d.ag._("{cartItemsQuantity, plural, one {Your cart contains 1 item} other {Your cart contains {cartItemsQuantity} items}}",{cartItemsQuantity:X})},n),{},{locale:T}),null===(e=r.product)||void 0===e?void 0:e.id)}})})})]}),(0,N.jsx)("div",{className:C()(V().summary,(0,i.Z)({},V().summaryForEmptyCart,it)),children:(0,N.jsx)(m.VD,{onRedirect:rt,currency:Z,onClose:function(){return location.assign("/".concat(T,"/search"))},subtotal:H.length>0?H:[{amount:0,currency:Z}],withTopBorder:it,onCartPage:!0,isCartEmpty:it,loading:p,appliedVolumeDiscounts:null===Y||void 0===Y?void 0:Y.appliedVolumeDiscounts.map((function(t){return I(I({},t),{},{discountAmount:t.totalDiscountAmount.map((function(t){return(0,b.Qq)(t)}))})})),totalDiscountAmount:null===Y||void 0===Y?void 0:Y.appliedVolumeDiscountsTotal.map((function(t){return(0,b.Qq)(t)})),locale:T})})]})]})},Q=!0,T=function(){return(0,N.jsx)(P,{})}},54476:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return r(17545)}])},23474:function(t){t.exports={wrapper:"CartView_wrapper__G5VcN",cart:"CartView_cart__fkBKi",header:"CartView_header__QCTN0",title:"CartView_title__FAnY8",itemsCount:"CartView_itemsCount__ZU633",summary:"CartView_summary__2Q_LG",summaryForEmptyCart:"CartView_summaryForEmptyCart__pE7uF",emptyCart:"CartView_emptyCart__cDU1h",emptyCartTitle:"CartView_emptyCartTitle__kiW1S",emptyCartMessage:"CartView_emptyCartMessage__ycW_o",loginButton:"CartView_loginButton__q4s9E",link:"CartView_link__RgBTE",itemsContainer:"CartView_itemsContainer__oE2q1",itemsContainerMobile:"CartView_itemsContainerMobile__5OYNu",rotating:"CartView_rotating__8kDFO"}}},function(t){t.O(0,[49774,92888,40179],(function(){return e=54476,t(t.s=e);var e}));var e=t.O();_N_E=e}]);
//# sourceMappingURL=cart-f4cbe6eb316845a8.js.map